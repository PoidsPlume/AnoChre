import anthropic
from pathlib import Path
import os
import re

def init_client():
	client = anthropic.Anthropic(
    	# defaults to os.environ.get("ANTHROPIC_API_KEY")
    	api_key= # add key,
	)	
	
def nouveau_dossier(path_name):
    newpath = path_name 
    if not os.path.exists(newpath):
        os.makedirs(newpath)
		
def make_titles(path):
	title_clean = "./clean_data/" + str(p)[8:len(str(p))]
	title_syl = "./syllabed_data/" + str(p)[8:len(str(p))]
	title_temp = "./annotated_temp/" + str(p)[8:len(str(p))]
	title_ano = "./annotated_data/" + str(p)[8:len(str(p))]
	return title_clean, title_syl, title_temp, title_ano

def remove_punctuation(text):
    cleaned_text = re.sub(r'[^\w\s\n]', '', text)
    return cleaned_text

def clean_file(p, title_clean):
	with open(p, 'r', encoding="utf-8") as f:
		raw_text = f.read()
	with open(title_clean, 'w', encoding = "utf-8") as f:
		f.write(remove_punctuation(raw_text))

def create_files(list:files):
	for file in files:
		with open(file, 'w+', encoding="utf-8") as f:
			f.write("")
		
def file_to_lines(filename):
	lines = []
	with open(filename, 'r', encoding="utf-8") as f:
		for line in filename:
			lines.append(line.strip())
	return lines

def find_dot_positions(input_string):
    positions = [i for i, char in enumerate(input_string) if char == '.']
    return positions

def correct_annotation(syllabed, annotated):
	annotated = list(annotated)
	dot_annotated = find_dot_positions(annotated)
	dot_syllabed = find_dot_positions(syllabed)
	if annotated[-1] == 'w':
		if (syllabed[-1] == 'e' or syllabed[-2:] == 'es' or (syllabed[-3:] == 'ent' and syllabed[-4:] != 'ment')): #prends en compte les terminsaisons de verbe en 'ent' en excluant les adverbes finissant par "ment"
			annotated[-1] = 'e'
	for i_a, i_s in zip(dot_annotated, dot_syllabed):
		if annotated[i_a - 1] == 'w':
			if (syllabed[i_s - 1] == 'e' and syllabed[i_s+2] in ['a', 'à', 'e', 'é', 'è', 'i', 'o']): #exclue le u car la syllabe n'est pas élidée quand c'est un v
				annotated[i_a - 1] = 'e'
	return "".join(annotated)

def get_annotation_tmp(verse):
	message = client.messages.create(
    	model="claude-3-5-sonnet-20241022",
    	max_tokens=50,
    	temperature=0,
    	system="You are a philologist expert in the versification of Old French. Your task is to mark strong and weak syllables as it would be pronounced in Old French given following instructions and knowledge.\n\n<instructions>\n- Mark strong syllable with \"S\"\n- Mark weak syllable with \"w\"\n- Keep the period \".\" between words\n- The amount of \".\" in output must be the same as in input\n</instruction>\n\n<knowledge>\n- Words are separated with period \".\"\n- Syllables are separated with \"-\" inside each word\n- Function words only have weak syllables\n- Function words are prepositions, pronouns, auxiliary verbs, conjunctions, grammatical articles or particles\n- If the word is a verb/noun/adjective the last syllable is strong. If the last syllable ends with \"e\", \"es\" (or \"ent\" for verb) it's weak and the penultimate syllable is strong\n</knowledge>\n\n<examples>\n\n<example>\n<verse>\nLi. vi-lains. dit. an. son. res-pit\n</verse>\n<ideal_output>\nw.wS.S.w.w.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nque. tel. cho-se. a. l'an. an. des-pit\n</verse>\n<ideal_output>\nw.w.Sw.w.S.w.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nqui. mout. valt. mialz. que. l'an. ne. cui-de\n</verse>\n<ideal_output>\nw.w.S.w.w.w.w.Sw\n</ideal_output>\n</example>\n\n<example>\n<verse>\npor. ce. fet. bien. qui. son. es-tui-de\n</verse>\n<ideal_output>\nw.w.S.w.w.w.wSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\na-tor-ne. a. bien. quel. que. il. l'ait\n</verse>\n<ideal_output>\nwSw.w.w.w.w.w.w\n</ideal_output>\n</example>\n\n<example>\n<verse>\ncar. qui. son. es-tui-de. an-tre-lait\n</verse>\n<ideal_output>\nw.w.w.wSw.wwS\n</ideal_output>\n</example>\n\n<example>\n<verse>\ntost. i. puet. tel. cho-se. tei-sir\n</verse>\n<ideal_output>\nw.w.w.w.Sw.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nqui. mout. van-droit. puis. a. plei-sir\n</verse>\n<ideal_output>\nw.w.wS.w.w.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nque. jan. av-roi-e. grant. mes-tier\n</verse>\n<ideal_output>\nw.w.www.w.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nqui. li. lo-e. le. bien. a. fe-re\n</verse>\n<ideal_output>\nw.w.Sw.w.w.w.Sw\n</ideal_output>\n</example>\n\n<example>\n<verse>\net. les. hiau-mes. clers. et. lui-sanz\n</verse>\n<ideal_output>\nw.w.Sw.S.w.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nNe-nil. vas-lez. ce. ne. puet. es-tre\n</verse>\n<ideal_output>\nwS.wS.w.w.w.ww\n</ideal_output>\n</example>\n\n<example>\n<verse>\nLi. a-pos-toi-les. nien. rit. mi-e\n</verse>\n<ideal_output>\nw.wwSw.w.S.Sw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nEn. la. soi-e. cham-bre. de-mai-ne\n</verse>\n<ideal_output>\nw.w.Sw.Sw.wSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nMol-li-e. est. de-vant. lui. la. pla-che\n</verse>\n<ideal_output>\nwSw.w.wS.w.w.Sw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nMout. li-e-ment. a-vant. la-pe-le\n</verse>\n<ideal_output>\nw.wwS.wS.wSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nla. plus. be-le. a. que. que. il. tort\n</verse>\n<ideal_output>\nw.w.Sw.w.w.w.w.S \n</ideal_output>\n</example>\n\n<example>\n<verse>\nles. cha-ce-ors. a-pa-rel-lier\n</verse>\n<ideal_output>\nw.wwS.wwwS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nlor. ars. et. lor. sai-e-tes. ont\n</verse>\n<ideal_output>\nw.S.w.w.wSw.w\n</ideal_output>\n</example>\n\n<example>\n<verse>\nli. au-tre. jo-ent. dau-tre. part\n</verse>\n<ideal_output>\nw.Sw.Sw.Sw.S\n</ideal_output>\n</example>\n\n<example>\n<verse>\nSi. oel. si. grant. cla-rté. ran-doi-ent\n</verse>\n<ideal_output>\nw.w.w.S.wS.wSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCist. pa-ïs. est. vos-tres. toz. qui-tes\n</verse>\n<ideal_output>\nw.wS.w.ww.w.Sw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQue. je. po-ïs-se. ar-mes. por-ter\n</verse>\n<ideal_output>\nw.w.wSw.Sw.Sw\n </ideal_output>\n</example>\n\n<example>\n<verse>\nQue. nan. di-roi-e. la. mi-tié\n</verse>\n<ideal_output>\nw.w.wSw.w.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nDe. la. ve-ü-e. de. lor. ialz\n</verse>\n<ideal_output>\nw.w.wSw.w.w.S\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQui. la. lein-gue. av-oit. es-mo-lu-e\n</verse>\n<ideal_output>\nw.w.Sw.ww.wwSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCil. che-va-lier. sa-tro-pe-le-rent\n</verse>\n<ideal_output>\nw.wwS.wwwSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nDï-ent. quil. ai-ment. mes. il. man-tent\n</verse>\n<ideal_output>\nSw.w.Sw.w.w.Sw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nIl. nest. cor-tei-si-e. ne. san\n</verse>\n<ideal_output>\nw.w.wwSw.w.w\n </ideal_output>\n</example>\n\n<example>\n<verse>\nLa. la. tro-vai. si. a-fei-tie-e\n</verse>\n<ideal_output>\nw.w.wS.w.wwSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nSi. bien. par-lant. si. an-sei-gni-e\n</verse>\n<ideal_output>\nw.w.wS.w.wwSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nSo-iez. a. cort. et. sa-chiez. bien.\n</verse>\n<ideal_output>\nww.w.S.w.wS.w\n</ideal_output>\n</example>\n\n<example>\n<verse>\nDel. re-me-noir. pro-ier. vos. vuel\n</verse>\n<ideal_output>\nw.wwS.wS.w.S\n </ideal_output>\n</example>\n\n<example>\n<verse>\nEt. la. re-ï-ne. an-cor. lan. pri-e\n</verse>\n<ideal_output>\nw.w.wSw.wS.w.Sw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nMes. li. cuens. Gui-na-bles. lo-ï\n</verse>\n<ideal_output>\nw.w.S.wSw.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCon. se-le. ge-üst. mor-te. an. bie-re\n</verse>\n<ideal_output>\nw.ww.wS.Se.w.Sw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nque. joi-e. me. vo-loi-ent. fei-re\n</verse>\n<ideal_output>\nw.Sw.w.wSw.Sw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nA. man-gier. fet. il. me. do-nez\n</verse>\n<ideal_output>\nw.wS.w.w.w.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nbrai-es. et. chau-ces. ce. me. san-ble\n</verse>\n<ideal_output>\nSw.w.Sw.w.w.Sw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nBiaus. fils. i. san. vos. vuel. a-pran-dre\n</verse>\n<ideal_output>\nw.S.w.w.w.S.wSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nSi. sac-re-fi-e. lan. le. cors\n</verse>\n<ideal_output>\nw.wwSw.w.w.S\n</ideal_output>\n</example>\n\n<example>\n<verse>\nMien. es-sï-ent. sil. le. se-üst\n</verse>\n<ideal_output>\nw.wSw.w.w.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nA-mours. vi-lai-ne-ment. le. li-e\n</verse>\n<ideal_output>\nwS.wwwS.w.Sw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQuau. cuer. li. est. li. feulz. sail-lis\n</verse>\n<ideal_output>\nw.S.w.w.w.S.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCe-le. qui. nes-toit. mi-e. fo-le\n</verse>\n<ideal_output>\nww.w.ww.Sw.Sw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nO-ïl. ce. tes-moi-gnent. et. di-ent\n</verse>\n<ideal_output>\nwS.w.wSw.w.Sw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nA. la. ro-ï-ne. re-gar-de-e\n</verse>\n<ideal_output>\nw.w.wSw.wwSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCe-ste. dist. il. nest. pas. far-de-e\n</verse>\n<ideal_output>\nww.S.w.w.w.wSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nLi. vif. de-ab-le. vos. quer-roi-ent\n</verse>\n<ideal_output>\nw.S.wSw.w.wSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nEt. quant. il. vos. a. tant. te-nu-e\n</verse>\n<ideal_output>\nw.w.w.w.w.w.wSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nMais. bien. me. de-vés. cla-mer. cui-te\n</verse>\n<ideal_output>\nw.w.w.wS.wS.Sw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nNe. tant. de. hiau-mes. re-lui-sans\n</verse>\n<ideal_output>\nw.w.w.Sw.wwS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nLi. rois. mon-te. en. son. pa-le-froi\n</verse>\n<ideal_output>\nw.S.Se.w.w.wwS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nLa. ri-vie-re. ont. pas-se-e. tost\n</verse>\n<ideal_output>\nw.wSw.w.wSw.w\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQui. ne. li. fust. lu-és. a-por-te-e\n</verse>\n<ideal_output>\nw.w.w.w.wS.wwSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nPan-cris. ot. non. si. fu. molt. biax\n</verse>\n<ideal_output>\nwS.w.w.w.w.w.S\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCar. de. grant. biau-té. lot. ve-ü\n</verse>\n<ideal_output>\nw.w.w.wS.w.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nNe. cui-doi-e. pas. que. fust. vis\n</verse>\n<ideal_output>\nw.wSw.w.w.w.S\n</ideal_output>\n</example>\n\n<example>\n<verse>\nVo-lan-tiers. pas-sast. la. ri-vie-re\n</verse>\n<ideal_output>\nwwS.wS.wwSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nAn-tiers. qui. molt. ert. forz. et. biax\n</verse>\n<ideal_output>\nwS.w.w.w.S.w.S\n</ideal_output>\n</example>\n\n<example>\n<verse>\nEt. que. la. grant. biau-té. ver-ra\n</verse>\n<ideal_output>\nw.w.w.w.wS.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQue. che-va-liers. ne. puet. lo-ier\n</verse>\n<ideal_output>\nw.wwS.w.w.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCar. ne. se-roi-e. pas. à. ai-se\n</verse>\n<ideal_output>\nw.w.wSw.w.w.Sw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nSe. gen-co-re. ne. vous. vé-oi-e\n</verse>\n<ideal_output>\nw.wSw.w.w.wSw\n </ideal_output>\n</example>\n\n<example>\n<verse>\nA-tant. se. mi-sent. à. la. voi-e\n</verse>\n<ideal_output>\nwS.w.Sw.w.w.Sw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nDont. el-le. vient. ù. el-le. va\n</verse>\n<ideal_output>\nw.ww.S.w.ww.S\n</ideal_output>\n</example>\n\n<example>\n<verse>\nEt. sa-chiez. bien. tot. sant. dou-tan-ce\n</verse>\n<ideal_output>\nw.wS.w.w.w.wSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQue. se. cha. poez. re-u-e-nit\n</verse>\n<ideal_output>\nw.w.S.w.wwwS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQu'il. cui-de. bien. ent-rer. la-iens\n</verse>\n<ideal_output>\nw.Sw.w.wS.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nUe-nir. par. la. joi-e. ter-res-tre\n</verse>\n<ideal_output>\nwS.w.w.Sw.wSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nNe. por. grant. pris. ne. por. pro-e-ce\n</verse>\n<ideal_output>\nw.w.w.S.w.w.wSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQue. il. nía-nuit. de. lies-cou-ter\n</verse>\n<ideal_output>\nw.w.wS.w.wwS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCar. ne. po-roi-e. hui. a-con-ter\n</verse>\n<ideal_output>\nw.w.wSw.w.wwS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nSa. biau-te. ne. son. har-de-ment\n</verse>\n<ideal_output>\nw.Sw.w.w.wwS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nEt. si. vous. di. ou-tre-e-ment\n</verse>\n<ideal_output>\nw.w.w.S.wwwS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nLa. viel-le E-i. tant. set. dien-gien\n</verse>\n<ideal_output>\nw.Se.wS.w.w.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nVait. sient. Ro-bers. sans. phuis. ai-den-dre\n</verse>\n<ideal_output>\nS.w.wS.w.w.wSw\n </ideal_output>\n</example>\n\n<example>\n<verse>\nQu. les. gens. i. a-voi-ent. fai-te\n</verse>\n<ideal_output>\nw.w.S.w.www.Sw\n </ideal_output>\n</example>\n\n<example>\n<verse>\nRo-bers. qui. pie-cha. ne. par-la\n</verse>\n<ideal_output>\nwS.w.wS.w.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nLe. sanc. en-tor. les. ble-che-u-res\n</verse>\n<ideal_output>\nw.S.wS.w.wwSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCar. fur-ni-e. a. nos-tre. be-soi-gne\n</verse>\n<ideal_output>\nw.wSe.w.ww.wSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nMout. a. le. cuer. fe-lon. et. dur\n</verse>\n<ideal_output>\nw.w.w.S.wS.w.S\n</ideal_output>\n</example>\n\n<example>\n<verse>\nJe. ne. quier. rien. da-mer. sa-voir\n</verse>\n<ideal_output>\nw.w.S.W.wS.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCar. il. cri-ent. se-le. lot. par-ler\n</verse>\n<ideal_output>\nw.w.Sw.ww.w.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nAins. que. de-main. voi-e. so-leil\n</verse>\n<ideal_output>\nw.w.wS.Sw.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQueus. a-mors. est. ce. dont. me. duel\n</verse>\n<ideal_output>\nw.wS.w.w.w.w.S\n</ideal_output>\n</example>\n\n<example>\n<verse>\nNe. po-voit. de. li. cho-se. o-ÿr\n</verse>\n<ideal_output>\nw.wS.w.w.Sw.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQui. la. pe-üst. fai-re. es-jo-ÿr\n</verse>\n<ideal_output>\nw.w.wS.Sw.wwS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQuant. tous. cil. qui. la. cou-gnois-soi-ent\n</verse>\n<ideal_output>\nw.w.w.w.w.wwSw\n </ideal_output>\n</example>\n\n<example>\n<verse>\nQui. pe-che-ürs. sa-ge-ment. bat\n</verse>\n<ideal_output>\nw.wwS.wwS.w\n </ideal_output>\n</example>\n\n<example>\n<verse>\nEn. sa. cham-bre. pri-ve-e-ment\n</verse>\n<ideal_output>\nw.w.Sw.wwwS \n</ideal_output>\n</example>\n\n<example>\n<verse>\nquil. ne. po-ënt. sen-sam-ble. non\n</verse>\n<ideal_output>\nw.w.wS.wSw.w\n</ideal_output>\n</example>\n\n<example>\n<verse>\nne. de. grant. fet. ne. de. be-soi-gne\n</verse>\n<ideal_output>\nw.w.w.S.w.w.wSw\n </ideal_output>\n</example>\n\n<example>\n<verse>\ndes. oi-sil-lons. les. chans. di-vers\n</verse>\n<ideal_output>\nw.wwS.w.S.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nLa. grant. beau-té. li. des-crit. to-te\n</verse>\n<ideal_output>\nw.w.wS.w.wS.Sw\n </ideal_output>\n</example>\n\n<example>\n<verse>\nja. sa. bo-ne. che-va-le-ri-e\n</verse>\n<ideal_output>\nw.w.Sw.wwwSw\n</ideal_output>\n</example>\n\n<example>\n<verse>\nEn. hau-te. mer. puis. si. sen. vont\n</verse>\n<ideal_output>\nw.Sw.S.w.w.w.S\n </ideal_output>\n</example>\n\n<example>\n<verse>\nAi. moult. le. cuer. lié. et. joi-ant\n</verse>\n<ideal_output>\nw.w.w.S.S.w.wS\n</ideal_output>\n</example>\n\n<example>\n<verse>\nMoult. les. con-joit. moult. les. hon-neu-re\n</verse>\n<ideal_output>\nw.w.wS.w.w.wSw\n </ideal_output>\n</example>\n\n<example>\n<verse>\nLi. cuens. se. cou-che. en-mi. le. cuer\n</verse>\n<ideal_output>\nw.S.w.Se.wS.w.S\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQui. moult. fu. biax. et. bien. gar-nis\n</verse>\n<ideal_output>\nw.w.w.S.w.w.wS\n</examples>",
    	messages=[
        	{
            	"role": "user",
            	"content": [
                	{
                    	"type": "text",
                    	"text": f"Annotate this verse: {verse}\nPrint only the output. Do not add any other explanations."
                	}
            	]
        	}
    	]
	)
	return message.content

def get_syllabification(verse): 
	message = client.messages.create(
    	model="claude-3-5-sonnet-20241022",
    	max_tokens=100,
    	temperature=0,
    	system="You are a philologist expert in the versification of Old French. Your task is to divide verse in words and syllable given following instructions and knowledge.\n\n<instructions>\n- Mark the end of each word with a period \".\" in your output\n- No \".\" between syllables inside of the same word\n- Add an hyphen \"-\" between syllables inside of the same word\n</instructions>\n\n<knowledge>\n- Syllable: a unit of pronunciation having one vowel sound, with or without surrounding consonants.\n- Syllabification: break words into syllable based on vowel and consonant patterns\n- Mute 'e' (IMPORTANT): inculde the mute 'e' in syllable countes and pronunciaitons, as it was pronounced in Old French, even if it can be elided.\n- Diphthong: in Old French some groups of letters such as \"oi\", \"ai\", \"ui\", \"ier\" are pronounced as a single syllable.\n- Example: \"chevalier\" = che-va-lier (3 syllables), \"salue\" = sa-lu-e (3 syllables), \"cheoir\" = che-oir (2 syllables), \"chacier\" = cha-cier (2 syllables), \"mariage\" = ma-ri-a-ge (4 syllables), \"lance\" = lan-ce (2 syllables), \"lionciau\" = lion-ci-au (3 syllables)\n</knowledge>\n\n<examples></ideal_output>\n</example>\n\n<example>\n<verse>\nLi vilains dit an son respit</verse>\n<ideal_output>\nLi. vi-lains. dit. an. son. res-pit\n</ideal_output>\n</example>\n\n<example>\n<verse>\nque tel chose a l'an an despit</verse>\n<ideal_output>\nque. tel. cho-se. a. l'an. an. des-pit\n</ideal_output>\n</example>\n\n<example>\n<verse>\nqui mout valt mialz que l' an ne cuide</verse>\n<ideal_output>\nqui. mout. valt. mialz. que. l'an. ne. cui-de\n</ideal_output>\n</example>\n\n<example>\n<verse>\npor ce fet bien qui son estuide</verse>\n<ideal_output>\npor. ce. fet. bien. qui. son. es-tui-de\n</ideal_output>\n</example>\n\n<example>\n<verse>\natorne a bien quel que il l'ait</verse>\n<ideal_output>\n\"a-tor-ne. a. bien. quel. que. il. l'ait\"\n</ideal_output>\n</example>\n\n<example>\n<verse>\ncar qui son estuide antrelait</verse>\n<ideal_output>\n\"car. qui. son. es-tui-de. an-tre-lait\"\n</ideal_output>\n</example>\n\n<example>\n<verse>\ntost i puet tel chose teisir</verse>\n<ideal_output>\ntost. i. puet. tel. cho-se. tei-sir\n</ideal_output>\n</example>\n\n<example>\n<verse>\nqui mout vandroit puis a pleisir</verse>\n<ideal_output>\nqui. mout. van-droit. puis. a. plei-sir\n</ideal_output>\n</example>\n\n<example>\n<verse>\nque jan avroie grant mestier</verse>\n<ideal_output>\nque. jan. av-roi-e. grant. mes-tier\n</ideal_output>\n</example>\n\n<example>\n<verse>\nqui li loe le bien a fere</verse>\n<ideal_output>\nqui. li. lo-e. le. bien. a. fe-re\n</ideal_output>\n</example>\n\n<example>\n<verse>\net les hiaumes clers et luisanz</verse>\n<ideal_output>\net. les. hiau-mes. clers. et. lui-sanz\n</ideal_output>\n</example>\n\n<example>\n<verse>\nNenil vaslez ce ne puet estre</verse>\n<ideal_output>\nNe-nil. vas-lez. ce. ne. puet. es-tre\n</ideal_output>\n</example>\n\n<example>\n<verse>\nLi apostoiles níen rit mie</verse>\n<ideal_output>\nLi. a-pos-toi-les. nien. rit. mi-e\n</ideal_output>\n</example>\n\n<example>\n<verse>\nEn la soie chambre demaine</verse>\n<ideal_output>\nEn. la. soi-e. cham-bre. de-mai-ne\n</ideal_output>\n</example>\n\n<example>\n<verse>\nMollie est devant lui la plache</verse>\n<ideal_output>\nMol-li-e. est. de-vant. lui. la. pla-che\n</ideal_output>\n</example>\n\n<example>\n<verse>\nMout liement avant lapele</verse>\n<ideal_output>\nMout. li-e-ment. a-vant. la-pe-le\n</ideal_output>\n</example>\n\n<example>\n<verse>\nla plus bele a que que il tort</verse>\n<ideal_output>\nla. plus. be-le. a. que. que. il. tort\n </ideal_output>\n</example>\n\n<example>\n<verse>\nles chaceors aparellier</verse>\n<ideal_output>\nles. cha-ce-ors. a-pa-rel-lier\n</ideal_output>\n</example>\n\n<example>\n<verse>\nlor ars et lor saietes ont</verse>\n<ideal_output>\nlor. ars. et. lor. sai-e-tes. ont\n</ideal_output>\n</example>\n\n<example>\n<verse>\nli autre joent dautre part</verse>\n<ideal_output>\nli. au-tre. jo-ent. dau-tre. part\n</ideal_output>\n</example>\n\n<example>\n<verse>\nSi oel si grant clarté randoient</verse>\n<ideal_output>\nSi. oel. si. grant. cla-rté. ran-doi-ent\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCist païs est vostres toz quites</verse>\n<ideal_output>\nCist. pa-ïs. est. vos-tres. toz. qui-tes\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQue je poïsse armes porter</verse>\n<ideal_output>\nQue. je. po-ïs-se. ar-mes. por-ter\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQue nan diroie la mitié</verse>\n<ideal_output>\nQue. nan. di-roi-e. la. mi-tié\n</ideal_output>\n</example>\n\n<example>\n<verse>\nDe la veüe de lor ialz</verse>\n<ideal_output>\nDe. la. ve-ü-e. de. lor. ialz\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQui la leingue avoit esmolue</verse>\n<ideal_output>\nQui. la. lein-gue. av-oit. es-mo-lu-e\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCil chevalier satropelerent</verse>\n<ideal_output>\nCil. che-va-lier. sa-tro-pe-le-rent\n</ideal_output>\n</example>\n\n<example>\n<verse>\nDïent quil aiment mes il mantent</verse>\n<ideal_output>\nDï-ent. quil. ai-ment. mes. il. man-tent\n</ideal_output>\n</example>\n\n<example>\n<verse>\nIl nest corteisie ne san</verse>\n<ideal_output>\nIl. nest. cor-tei-si-e. ne. san\n </ideal_output>\n</example>\n\n<example>\n<verse>\nLa la trovai si afeitiee</verse>\n<ideal_output>\nLa. la. tro-vai. si. a-fei-tie-e\n</ideal_output>\n</example>\n\n<example>\n<verse>\nSi bien parlant si anseigniee</verse>\n<ideal_output>\nSi. bien. par-lant. si. an-sei-gni-e\n</ideal_output>\n</example>\n\n<example>\n<verse>\nSoiez a cort et sachiez bien</verse>\n<ideal_output>\nSo-iez. a. cort. et. sa-chiez. bien.\n</ideal_output>\n</example>\n\n<example>\n<verse>\nDel remenoir proier vos vuel</verse>\n<ideal_output>\nDel. re-me-noir. pro-ier. vos. vuel\n </ideal_output>\n</example>\n\n<example>\n<verse>\nEt la reïne ancor lan prie</verse>\n<ideal_output>\nEt. la. re-ï-ne. an-cor. lan. pri-e\n</ideal_output>\n</example>\n\n<example>\n<verse>\nMes li cuens Guinables loï</verse>\n<ideal_output>\nMes. li. cuens. Gui-na-bles. lo-ï\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCon sele geüst morte an biere</verse>\n<ideal_output>\nCon. se-le. ge-üst. mor-te. an. bie-re\n</ideal_output>\n</example>\n\n<example>\n<verse>\nque joie me voloient feire</verse>\n<ideal_output>\nque. joi-e. me. vo-loi-ent. fei-re\n</ideal_output>\n</example>\n\n<example>\n<verse>\nA mangier fet il me donez</verse>\n<ideal_output>\nA. man-gier. fet. il. me. do-nez\n</ideal_output>\n</example>\n\n<example>\n<verse>\nbraies et chauces ce me sanble</verse>\n<ideal_output>\nbrai-es. et. chau-ces. ce. me. san-ble\n</ideal_output>\n</example>\n\n<example>\n<verse>\nBiaus filz i san vos vuel aprandre</verse>\n<ideal_output>\nBiaus. fils. i. san. vos. vuel. a-pran-dre\n</ideal_output>\n</example>\n\n<example>\n<verse>\nSi sacrefie lan le cors</verse>\n<ideal_output>\nSi. sac-re-fi-e. lan. le. cors\n</ideal_output>\n</example>\n\n<example>\n<verse>\nMien essïent sil le seüst</verse>\n<ideal_output>\nMien. es-sï-ent. sil. le. se-üst\n</ideal_output>\n</example>\n\n<example>\n<verse>\nAmours vilainement le lie</verse>\n<ideal_output>\nA-mours. vi-lai-ne-ment. le. li-e\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQuau cuer li est li feulz saillis</verse>\n<ideal_output>\nQuau. cuer. li. est. li. feulz. sail-lis\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCele qui nestoit mie fole</verse>\n<ideal_output>\nCe-le. qui. nes-toit. mi-e. fo-le\n</ideal_output>\n</example>\n\n<example>\n<verse>\nOïl ce tesmoignent et dient</verse>\n<ideal_output>\nO-ïl. ce. tes-moi-gnent. et. di-ent\n</ideal_output>\n</example>\n\n<example>\n<verse>\nA la roïne regardee</verse>\n<ideal_output>\nA. la. ro-ï-ne. re-gar-de-e\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCeste dist il nest pas fardee</verse>\n<ideal_output>\nCe-ste. dist. il. nest. pas. far-de-e\n</ideal_output>\n</example>\n\n<example>\n<verse>\nLi vif deable vos querroient</verse>\n<ideal_output>\nLi. vif. de-ab-le. vos. quer-roi-ent\n</ideal_output>\n</example>\n\n<example>\n<verse>\nEt quant il vos a tant tenue</verse>\n<ideal_output>\nEt. quant. il. vos. a. tant. te-nu-e\n</ideal_output>\n</example>\n\n<example>\n<verse>\nMais bien me devés clamer cuite</verse>\n<ideal_output>\nMais. bien. me. de-vés. cla-mer. cui-te\n</ideal_output>\n</example>\n\n<example>\n<verse>\nNe tant de hiaumes reluisans</verse>\n<ideal_output>\nNe. tant. de. hiau-mes. re-lui-sans\n</ideal_output>\n</example>\n\n<example>\n<verse>\nLi rois monte en son palefroi</verse>\n<ideal_output>\nLi. rois. mon-te. en. son. pa-le-froi\n</ideal_output>\n</example>\n\n<example>\n<verse>\nLa riviere ont passee tost</verse>\n<ideal_output>\nLa. ri-vie-re. ont. pas-se-e. tost.\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQui ne li fust lués aportee</verse>\n<ideal_output>\nQui. ne. li. fust. lu-és. a-por-te-e\n</ideal_output>\n</example>\n\n<example>\n<verse>\nPancris ot non si fu molt biax</verse>\n<ideal_output>\nPan-cris. ot. non. si. fu. molt. biax\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCar de grant biauté lot veü</verse>\n<ideal_output>\nCar. de. grant. biau-té. lot. ve-ü\n</ideal_output>\n</example>\n\n<example>\n<verse>\nNe cuidoie pas que fust vis</verse>\n<ideal_output>\nNe. cui-doi-e. pas. que. fust. vis\n</ideal_output>\n</example>\n\n<example>\n<verse>\nVolantiers passast la riviere</verse>\n<ideal_output>\nVo-lan-tiers. pas-sast. la. ri-vie-re\n</ideal_output>\n</example>\n\n<example>\n<verse>\nAntiers qui molt ert forz et biax</verse>\n<ideal_output>\nAn-tiers. qui. molt. ert. forz. et. biax\n</ideal_output>\n</example>\n\n<example>\n<verse>\nEt que la grant biauté verra</verse>\n<ideal_output>\nEt. que. la. grant. biau-té. ver-ra\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQue chevaliers ne puet loier</verse>\n<ideal_output>\nQue. che-va-liers. ne. puet. lo-ier\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCar ne seroie pas à aise</verse>\n<ideal_output>\nCar. ne. se-roi-e. pas. à. ai-se\n</ideal_output>\n</example>\n\n<example>\n<verse>\nSe gencore ne vous véoie</verse>\n<ideal_output>\nSe. gen-co-re. ne. vous. vé-oi-e\n </ideal_output>\n</example>\n\n<example>\n<verse>\nAtant se misent à la voie</verse>\n<ideal_output>\nA-tant. se. mi-sent. à. la. voi-e\n</ideal_output>\n</example>\n\n<example>\n<verse>\nDont elle vient ù elle va</verse>\n<ideal_output>\nDont. el-le. vient. ù. el-le. va\n</ideal_output>\n</example>\n\n<example>\n<verse>\nEt sachiez bien tot sant doutance</verse>\n<ideal_output>\nEt. sa-chiez. bien. tot. sant. dou-tan-ce\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQue se cha poez reuenit</verse>\n<ideal_output>\nQue. se. cha. poez. re-u-e-nit\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQu'il cuide bien entrer laiens</verse>\n<ideal_output>\nQu'il. cui-de. bien. ent-rer. la-iens\n</ideal_output>\n</example>\n\n<example>\n<verse>\nUenir par la ioie terrestre</verse>\n<ideal_output>\nUe-nir. par. la. joi-e. ter-res-tre\n</ideal_output>\n</example>\n\n<example>\n<verse>\nNe por grant pris ne por proece</verse>\n<ideal_output>\nNe. por. grant. pris. ne. por. pro-e-ce\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQue il níanuit de líescouter</verse>\n<ideal_output>\nQue. il. nía-nuit. de. lies-cou-ter\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCar ne poroie hui aconter</verse>\n<ideal_output>\nCar. ne. po-roi-e. hui. a-con-ter\n</ideal_output>\n</example>\n\n<example>\n<verse>\nSa biaute ne son hardement</verse>\n<ideal_output>\nSa. biau-te. ne. son. har-de-ment\n</ideal_output>\n</example>\n\n<example>\n<verse>\nEt si vous di outreement</verse>\n<ideal_output>\nEt. si. vous. di. ou-tre-e-ment\n</ideal_output>\n</example>\n\n<example>\n<verse>\nLa vielle Ei tant set díengien</verse>\n<ideal_output>\nLa. viel-le E-i. tant. set. dien-gien\n</ideal_output>\n</example>\n\n<example>\n<verse>\nVait síent Robers sans phuis aiendre</verse>\n<ideal_output>\nVait. sient. Ro-bers. sans. phuis. ai-den-dre\n </ideal_output>\n</example>\n\n<example>\n<verse>\nQue les gens i avoient faite</verse>\n<ideal_output>\nQu. les. gens. i. a-voi-ent. fai-te\n </ideal_output>\n</example>\n\n<example>\n<verse>\nRobers qui piecha ne parla</verse>\n<ideal_output>\nRo-bers. qui. pie-cha. ne. par-la\n</ideal_output>\n</example>\n\n<example>\n<verse>\nLe sanc entor les blecheures</verse>\n<ideal_output>\nLe. sanc. en-tor. les. ble-che-u-res\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCar furnie a nostre besoigne</verse>\n<ideal_output>\nCar. fur-ni-e. a. nos-tre. be-soi-gne\n</ideal_output>\n</example>\n\n<example>\n<verse>\nMout a le cuer felon et dur</verse>\n<ideal_output>\nMout. a. le. cuer. fe-lon. et. dur.\n</ideal_output>\n</example>\n\n<example>\n<verse>\nJe ne quier rien damer savoir</verse>\n<ideal_output>\nJe. ne. quier. rien. da-mer. sa-voir\n</ideal_output>\n</example>\n\n<example>\n<verse>\nCar il crient sele lot parler</verse>\n<ideal_output>\nCar. il. cri-ent. se-le. lot. par-ler\n</ideal_output>\n</example>\n\n<example>\n<verse>\nAins que demain voie soleil</verse>\n<ideal_output>\nAins. que. de-main. voi-e. so-leil\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQueus amors est ce dont me duel</verse>\n<ideal_output>\nQueus. a-mors. est. ce. dont. me. duel\n</ideal_output>\n</example>\n\n<example>\n<verse>\nNe pouoit de li chose oÿr</verse>\n<ideal_output>\nNe. po-voit. de. li. cho-se. o-ÿr\n </ideal_output>\n</example>\n\n<example>\n<verse>\nQui la peüst faire esjoÿr</verse>\n<ideal_output>\nQui. la. pe-üst. fai-re. es-jo-ÿr\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQuant tous cil qui la cougnoissoient</verse>\n<ideal_output>\nQuant. tous. cil. qui. la. cou-gnois-soi-ent\n </ideal_output>\n</example>\n\n<example>\n<verse>\nQui pecheürs sagement bat</verse>\n<ideal_output>\nQui. pe-che-ürs. sa-ge-ment. bat\n </ideal_output>\n</example>\n\n<example>\n<verse>\nEn sa chambre priveement</verse>\n<ideal_output>\nEn. sa. cham-bre. pri-ve-e-ment \n</ideal_output>\n</example>\n\n<example>\n<verse>\nquil ne poënt sensamble non</verse>\n<ideal_output>\nquil. ne. po-ënt. sen-sam-ble. non\n</ideal_output>\n</example>\n\n<example>\n<verse>\nne de grant fet ne de besoigne</verse>\n<ideal_output>\nne. de. grant. fet. ne. de. be-soi-gne\n </ideal_output>\n</example>\n\n<example>\n<verse>\ndes oisillons les chans divers</verse>\n<ideal_output>\ndes. oi-sil-lons. les. chans. di-vers\n</ideal_output>\n</example>\n\n<example>\n<verse>\nLa grant beauté li descrit tote</verse>\n<ideal_output>\nLa. grant. beau-té. li. des-crit. to-te\n </ideal_output>\n</example>\n\n<example>\n<verse>\nja sa bone chevalerie</verse>\n<ideal_output>\nja. sa. bo-ne. che-va-le-ri-e\n</ideal_output>\n</example>\n\n<example>\n<verse>\nEn haute mer puis si sen vont</verse>\n<ideal_output>\nEn. hau-te. mer. puis. si. sen. vont\n </ideal_output>\n</example>\n\n<example>\n<verse>\nAi moult le cuer lié et joiant</verse>\n<ideal_output>\nAi. moult. le. cuer. lié. et. joi-ant\n</ideal_output>\n</example>\n\n<example>\n<verse>\nMoult les conjoit moult les honneure</verse>\n<ideal_output>\nMoult. les. con-joit. moult. les. hon-neu-re\n </ideal_output>\n</example>\n\n<example>\n<verse>\nLi cuens se couche enmi le cuer</verse>\n<ideal_output>\nLi. cuens. se. cou-che. en-mi. le. cuer\n</ideal_output>\n</example>\n\n<example>\n<verse>\nQui moult fu biax et bien garnis</verse>\n<ideal_output>\nQui. moult. fu. biax. et. bien. gar-nis\n</examples>",
    	messages=[
        	{
            	"role": "user",
            	"content": [
                	{
                    	"type": "text",
                    	"text": f"Divide this verse : {verse}\nPrint only the output. Do not add any other explanations."
                	}
            	]
        	}
    	]
	)
	return message.content

def main() :
	init_client()
	nouveau_dossier("clean_data")
	nouveau_dossier("syllabed_data")
	nouveau_dossier("annotated_temp")
	nouveau_dossier("annotated_data")
	for p in Path('./raw_data/').glob('*.txt'):
		title_clean, title_syl, title_temp, title_ano = make_titles(p)
		clean_file(p, title_clean)
		create_files([title_syl, title_temp, title_ano]) #à faire/ overwrite existing files
		content = file_to_lines(title_clean)
		for line in content:
			syllabed = get_syllabification(line)
			with open(title_syl, 'a', encoding="utf-8") as f:
				f.write(syllabed + '\n')
			ano_tmp = get_annotation_tmp(syllabed)
			with open(title_temp, 'a', encoding="utf-8") as f:
				f.write(ano_tmp + '\n')
			annotated = correct_annotation(syllabed, ano_tmp)
			with open(title_ano, 'a', encoding="utf-8") as f:
				f.write(annotated + '\n')
			
		
